<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="iso-8859-1">
<title>Obsolete Projects</title>
<style>
body {
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
  background-color: #f9f9f9;
}
table {
  border-collapse: collapse;
  width: 100%;
  font-size: small;
}
th, td {
  padding: 4px 6px;
  text-align: left;
  border: 1px solid #ccc;
}
th {
  background-color: silver;
  color: black;
}
.yellow-row {
  background-color: yellow;
}
.white-row {
  background-color: white;
}
.header {
  background-color: #003366;
  color: #fff;
  text-align: center;
  padding: 6px;
  font-size: 18px;
}

#endBar {
background: black;
color: white;
text-align: center;
font-weight: bold;
padding: 4px;
font-size: 12px;
margin-top: 2px;
}

</style>
</head>
<body>
  <div class="header">Obsolete Projects</div>

  <table id="obsoleteTable">
    <thead>
      <tr>
        <th>Module</th>
        <th>Project Name</th>
        <th>Description</th>
        <th>Developer</th>
        <th>Manager</th>
      </tr>
    </thead>
    <tbody>
      <tr><td colspan="5">Loading...</td></tr>
    </tbody>
  </table>

  <div id="endBar">End</div>

<script>
async function loadObsoleteProjects() {
  try {
    const response = await fetch("/api/obsoleteprojects", {
      headers: { "x-iis-logon-user": "DOMAIN\\builduser" } // simulate LOGON_USER
    });
    const result = await response.json();
    const data = result.data;
    const tbody = document.querySelector("#obsoleteTable tbody");

    if (!data || data.length === 0) {
      tbody.innerHTML = "<tr><td colspan='5'>No obsolete projects found.</td></tr>";
      return;
    }

    tbody.innerHTML = "";
    let colorToggle = true;

    data.forEach(row => {
      const tr = document.createElement("tr");
      tr.className = colorToggle ? "yellow-row" : "white-row";
      colorToggle = !colorToggle;

      tr.innerHTML = `
        <td>${row.ModuleID || ""}</td>
        <td>${row.ProjectFileName || ""}</td>
        <td>${row.Description || ""}</td>
        <td>${row.DeveloperName || ""}</td>
        <td>${row.ManagerName || ""}</td>
      `;
      tbody.appendChild(tr);
    });
  } catch (err) {
    console.error("Error loading data:", err);
  }
}

loadObsoleteProjects();
</script>
</body>
</html>
